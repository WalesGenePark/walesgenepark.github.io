{{ define "main" }}
<div class="container">
    <h1 class="text-center py-5">{{ .Title }}</h1>
    
    <div class="row mb-4">
        <div class="col">
            <input type="text" id="eventSearch" class="form-control" placeholder="Search events...">
        </div>
    </div>
    
    <div id="calendar"></div>
</div>

<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.js'></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: [
            {{ range $.Site.Data.events }}
            {
                title: {{ .title }},
                start: {{ .start }},
                end: {{ .end }},
                allDay: {{ .allDay }}
            },
            {{ end }}
        ],
        eventContent: function(arg) {
            return {
                html: `
                    <div class="fc-content">
                        <div class="fc-time">${arg.timeText}</div>
                        <div class="fc-title">${arg.event.title}</div>
                    </div>
                `
            };
        }
    });
    calendar.render();

    // Search functionality
    document.getElementById('eventSearch').addEventListener('input', function(e) {
        var searchText = e.target.value.toLowerCase();
        var allEvents = calendar.getEvents();
        
        allEvents.forEach(function(event) {
            var title = event.title.toLowerCase(); // Convert event title to lowercase
            if (title.includes(searchText)) {
                event.setProp('display', 'auto');
            } else {
                event.setProp('display', 'none');
            }
        });
    });
});
</script>
{{ end }}